# å‘˜å·¥æ‰“å¡ç³»ç»Ÿ - Tauri ç‰ˆæœ¬å¼€å‘æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®åç§°
å‘˜å·¥æ‰“å¡ç³»ç»Ÿ (Check-In System)

### é¡¹ç›®ç®€ä»‹
è¿™æ˜¯ä¸€ä¸ªåŸºäº Supabase (PostgreSQL) åç«¯çš„æ¡Œé¢ç«¯å‘˜å·¥è€ƒå‹¤æ‰“å¡ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒçµæ´»çš„æ‰“å¡ç±»å‹é…ç½®ã€æ—¶é—´è§„åˆ™ç®¡ç†ã€è¿Ÿåˆ°æ£€æµ‹ã€è·¨æ—¥å·¥ä½œå‘¨æœŸã€ç»Ÿè®¡æŠ¥è¡¨ç­‰åŠŸèƒ½ã€‚å‘˜å·¥å¯ä»¥é€šè¿‡ç›´è§‚çš„æŒ‰é’®ç•Œé¢å¿«é€Ÿæ‰“å¡ï¼Œç®¡ç†å‘˜å¯ä»¥é…ç½®æ‰“å¡è§„åˆ™ã€æŸ¥çœ‹ç»Ÿè®¡æ•°æ®å¹¶å¯¼å‡ºæŠ¥è¡¨ã€‚

### æŠ€æœ¯æ ˆ
- **åŸç‰ˆæœ¬**ï¼šPython + PySide6 (Qt) + Supabase
- **ç›®æ ‡ç‰ˆæœ¬**ï¼šTauri (Rust + TypeScript/React) + Supabase

### æ ¸å¿ƒç‰¹ç‚¹
1. **æ¡Œé¢åº”ç”¨**ï¼šç¦»çº¿è¿è¡Œï¼Œæ•°æ®å­˜å‚¨åœ¨ Supabase äº‘æ•°æ®åº“
2. **å•å®ä¾‹è¿è¡Œ**ï¼šé˜²æ­¢é‡å¤å¯åŠ¨
3. **å¤šæ—¶åŒºæ”¯æŒ**ï¼šæ”¯æŒå…¬å¸æ—¶åŒºé…ç½®ï¼ˆå¦‚æŸ¬åŸ”å¯¨é‡‘è¾¹æ—¶é—´ Asia/Phnom_Penhï¼‰
4. **çµæ´»é…ç½®**ï¼šç®¡ç†å‘˜å¯è‡ªå®šä¹‰æ‰“å¡ç±»å‹ã€æ—¶é—´è§„åˆ™
5. **é›¶å»¶è¿ŸUI**ï¼šé‡‡ç”¨ä¹è§‚æ›´æ–°ç­–ç•¥ï¼Œæ‰“å¡åç«‹å³åé¦ˆ
6. **å®Œæ•´åŠŸèƒ½**ï¼šæ”¯æŒä¸Šä¸‹ç­ã€ä¸´æ—¶äº‹ä»¶ï¼ˆåˆé¤ã€å¼€ä¼šç­‰ï¼‰ã€è¿Ÿåˆ°æ£€æµ‹ã€è¶…æ—¶æé†’

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ•°æ®åº“ç±»å‹
PostgreSQL (é€šè¿‡ Supabase æ‰˜ç®¡)

### æ ¸å¿ƒè¡¨ç»“æ„

#### 1. users - ç”¨æˆ·è¡¨
```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    full_name VARCHAR(100) NOT NULL,
    is_admin BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT NOW()
);
```
**å­—æ®µè¯´æ˜**ï¼š
- `id`: ä¸»é”®ï¼Œè‡ªå¢
- `username`: ç”¨æˆ·åï¼Œå”¯ä¸€
- `password_hash`: å¯†ç å“ˆå¸Œå€¼ï¼ˆSHA256ï¼‰
- `full_name`: å‘˜å·¥çœŸå®å§“å
- `is_admin`: æ˜¯å¦æ˜¯ç®¡ç†å‘˜
- `created_at`: æ³¨å†Œæ—¶é—´

#### 2. action_types - æ‰“å¡ç±»å‹è¡¨
```sql
CREATE TABLE action_types (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50) UNIQUE NOT NULL,           -- è‹±æ–‡æ ‡è¯†
    button_text VARCHAR(50) NOT NULL,           -- æŒ‰é’®æ˜¾ç¤ºæ–‡å­—
    button_color VARCHAR(20) NOT NULL,          -- æŒ‰é’®é¢œè‰² (#RRGGBB)
    display_order INT DEFAULT 0,                -- æ˜¾ç¤ºæ’åº
    action_role INT NOT NULL,                   -- è§’è‰²ï¼š1=è¿›ç¨‹å¼€å§‹(ä¸Šç­), 2=è¿›ç¨‹ç»“æŸ(ä¸‹ç­), 3=äº‹ä»¶å¼€å§‹, 4=äº‹ä»¶ç»“æŸ(å›åº§)
    requires_pair BOOLEAN DEFAULT FALSE,        -- æ˜¯å¦éœ€è¦é…å¯¹
    pair_action_id INT REFERENCES action_types(id), -- é…å¯¹çš„åŠ¨ä½œç±»å‹ID
    is_active BOOLEAN DEFAULT TRUE,             -- æ˜¯å¦å¯ç”¨
    created_at TIMESTAMP DEFAULT NOW()
);
```
**å­—æ®µè¯´æ˜**ï¼š
- `action_role` åˆ†ç±»ï¼š
  - **1** = è¿›ç¨‹å¼€å§‹ï¼ˆä¸Šç­ï¼‰
  - **2** = è¿›ç¨‹ç»“æŸï¼ˆä¸‹ç­ï¼‰
  - **3** = äº‹ä»¶å¼€å§‹ï¼ˆåˆé¤ã€å¼€ä¼šã€æ‰“ç”µè¯ç­‰ä¸´æ—¶äº‹ä»¶ï¼‰
  - **4** = äº‹ä»¶ç»“æŸï¼ˆå›åº§ï¼‰
- `requires_pair`: å¦‚æœä¸º trueï¼Œåˆ™æ‰“å¡åéœ€è¦é…å¯¹çš„ç»“æŸåŠ¨ä½œ
- `pair_action_id`: é…å¯¹åŠ¨ä½œçš„IDï¼ˆä¾‹å¦‚"åˆé¤"é…å¯¹"å›åº§"ï¼‰

**é»˜è®¤æ•°æ®**ï¼š
```sql
-- ç³»ç»Ÿé»˜è®¤æ‰“å¡ç±»å‹ï¼ˆä¸å¯åˆ é™¤ï¼‰
INSERT INTO action_types (name, button_text, button_color, display_order, action_role, requires_pair, pair_action_id) VALUES
('clock_in', 'ä¸Šç­', '#4CAF50', 1, 1, TRUE, 2),      -- ä¸Šç­ â†’ é…å¯¹ä¸‹ç­
('clock_out', 'ä¸‹ç­', '#F44336', 2, 2, FALSE, NULL), -- ä¸‹ç­ï¼ˆè¢«é…å¯¹ï¼‰
('back_to_seat', 'å›åº§', '#607D8B', 100, 4, FALSE, NULL); -- å›åº§ï¼ˆé€šç”¨ç»“æŸï¼‰

-- å¯è‡ªå®šä¹‰çš„äº‹ä»¶ç±»å‹ï¼ˆç®¡ç†å‘˜æ·»åŠ ï¼‰
INSERT INTO action_types (name, button_text, button_color, display_order, action_role, requires_pair, pair_action_id) VALUES
('lunch', 'åˆé¤', '#FF9800', 10, 3, TRUE, (SELECT id FROM action_types WHERE name='back_to_seat')),
('meeting', 'å¼€ä¼š', '#9C27B0', 11, 3, TRUE, (SELECT id FROM action_types WHERE name='back_to_seat')),
('restroom', 'ä¸Šå•æ‰€', '#03A9F4', 12, 3, TRUE, (SELECT id FROM action_types WHERE name='back_to_seat'));
```

#### 3. time_rules - æ—¶é—´è§„åˆ™è¡¨
```sql
CREATE TABLE time_rules (
    id SERIAL PRIMARY KEY,
    rule_name VARCHAR(100) NOT NULL,            -- è§„åˆ™åç§°
    action_type_id INT REFERENCES action_types(id) ON DELETE CASCADE,
    expected_time TIME,                         -- æœŸæœ›æ—¶é—´ (å¦‚ 09:00:00)
    allow_early_minutes INT DEFAULT 0,          -- å…è®¸æ—©åˆ°åˆ†é’Ÿæ•°
    allow_late_minutes INT DEFAULT 0,           -- å…è®¸è¿Ÿåˆ°åˆ†é’Ÿæ•°
    max_duration_minutes INT,                   -- æœ€é•¿æŒç»­æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
    warning_minutes INT,                        -- æå‰æé†’æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
    timezone VARCHAR(50) DEFAULT 'Asia/Shanghai', -- æ—¶åŒº
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT NOW()
);
```
**å­—æ®µè¯´æ˜**ï¼š
- `expected_time`: æœŸæœ›æ‰“å¡æ—¶é—´ï¼ˆä¾‹å¦‚ä¸Šç­æ—¶é—´ 09:00:00ï¼‰
- `allow_early_minutes`: å…è®¸æå‰æ‰“å¡çš„åˆ†é’Ÿæ•°
- `allow_late_minutes`: å…è®¸è¿Ÿåˆ°çš„åˆ†é’Ÿæ•°ï¼ˆè¶…è¿‡æ­¤å€¼ç®—è¿Ÿåˆ°ï¼‰
- `max_duration_minutes`: æœ€é•¿æŒç»­æ—¶é—´ï¼ˆç”¨äºäº‹ä»¶ç±»å‹ï¼Œå¦‚åˆé¤æœ€é•¿60åˆ†é’Ÿï¼‰
- `warning_minutes`: è¾¾åˆ°æ­¤æ—¶é—´æ—¶å‘å‡ºæé†’ï¼ˆ80%æ—¶é•¿æ—¶æé†’ï¼‰
- `timezone`: å…¬å¸æ—¶åŒºï¼ˆå…¨å±€ç»Ÿä¸€ï¼Œå¦‚ Asia/Phnom_Penhï¼‰

**é»˜è®¤æ•°æ®ç¤ºä¾‹**ï¼š
```sql
INSERT INTO time_rules (rule_name, action_type_id, expected_time, allow_early_minutes, allow_late_minutes) VALUES
('ä¸Šç­æ—¶é—´è§„åˆ™', 1, '09:00:00', 30, 15),  -- ä¸Šç­ï¼š9ç‚¹ï¼Œå…è®¸æ—©åˆ°30åˆ†é’Ÿï¼Œå…è®¸è¿Ÿåˆ°15åˆ†é’Ÿ
('ä¸‹ç­æ—¶é—´è§„åˆ™', 2, '18:00:00', 0, 0);    -- ä¸‹ç­ï¼š18ç‚¹

INSERT INTO time_rules (rule_name, action_type_id, max_duration_minutes, warning_minutes) VALUES
('åˆé¤æ—¶é•¿é™åˆ¶', (SELECT id FROM action_types WHERE name='lunch'), 60, 48),  -- åˆé¤æœ€é•¿60åˆ†é’Ÿï¼Œ48åˆ†é’Ÿæ—¶æé†’
('ä¼šè®®æ—¶é•¿é™åˆ¶', (SELECT id FROM action_types WHERE name='meeting'), 120, 96); -- ä¼šè®®æœ€é•¿120åˆ†é’Ÿ
```

#### 4. check_ins - æ‰“å¡è®°å½•è¡¨
```sql
CREATE TABLE check_ins (
    id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(id) ON DELETE CASCADE,
    action_type_id INT REFERENCES action_types(id),
    check_time TIMESTAMP DEFAULT NOW(),         -- æ‰“å¡æ—¶é—´ï¼ˆç›´æ¥å­˜å‚¨å…¬å¸æ—¶åŒºæ—¶é—´ï¼Œæ— æ—¶åŒºä¿¡æ¯ï¼‰
    status VARCHAR(20) DEFAULT 'ongoing',       -- çŠ¶æ€ï¼šongoing, completed, overtime
    pair_check_in_id INT REFERENCES check_ins(id), -- é…å¯¹çš„æ‰“å¡è®°å½•ID
    duration_minutes INT,                       -- æŒç»­æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    note TEXT,                                  -- å¤‡æ³¨
    is_late BOOLEAN DEFAULT FALSE,              -- æ˜¯å¦è¿Ÿåˆ°
    created_at TIMESTAMP DEFAULT NOW()
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_check_ins_user_id ON check_ins(user_id);
CREATE INDEX idx_check_ins_check_time ON check_ins(check_time);
CREATE INDEX idx_check_ins_status ON check_ins(status);
CREATE INDEX idx_check_ins_is_late ON check_ins(is_late);
```
**å­—æ®µè¯´æ˜**ï¼š
- `check_time`: æ‰“å¡æ—¶é—´ï¼ˆå­˜å‚¨å…¬å¸æ—¶åŒºçš„æ—¶é—´ï¼Œæ— æ—¶åŒºæ ‡è®°ï¼‰
- `status`: æ‰“å¡çŠ¶æ€
  - **ongoing**: è¿›è¡Œä¸­ï¼ˆä¸Šç­åæœªä¸‹ç­ã€äº‹ä»¶å¼€å§‹åæœªç»“æŸï¼‰
  - **completed**: å·²å®Œæˆï¼ˆæ­£å¸¸å®Œæˆé…å¯¹ï¼‰
  - **overtime**: è¶…æ—¶ï¼ˆäº‹ä»¶è¶…è¿‡æœ€é•¿æ—¶é™ï¼‰
- `pair_check_in_id`: é…å¯¹è®°å½•IDï¼ˆå¦‚ä¸Šç­é…å¯¹ä¸‹ç­ã€åˆé¤é…å¯¹å›åº§ï¼‰
- `duration_minutes`: æŒç»­æ—¶é•¿ï¼ˆç»“æŸæ—¶è‡ªåŠ¨è®¡ç®—ï¼‰
- `is_late`: æ˜¯å¦è¿Ÿåˆ°ï¼ˆæ‰“å¡æ—¶æ ¹æ®æ—¶é—´è§„åˆ™è‡ªåŠ¨åˆ¤æ–­ï¼‰

#### 5. system_config - ç³»ç»Ÿé…ç½®è¡¨ï¼ˆå¯é€‰ï¼‰
```sql
CREATE TABLE system_config (
    id SERIAL PRIMARY KEY,
    config_key VARCHAR(100) UNIQUE NOT NULL,
    config_value TEXT NOT NULL,
    config_desc TEXT,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- é»˜è®¤é…ç½®
INSERT INTO system_config (config_key, config_value, config_desc) VALUES
('company_timezone', 'Asia/Phnom_Penh', 'å…¬å¸æ—¶åŒºè®¾ç½®'),
('app_version', '1.0.0', 'å½“å‰åº”ç”¨ç‰ˆæœ¬å·');
```

---

## ğŸ¨ UI ç•Œé¢è®¾è®¡

### ç•Œé¢ç»“æ„
ç³»ç»ŸåŒ…å« 3 ä¸ªä¸»è¦çª—å£ï¼š
1. **ç™»å½•/æ³¨å†Œçª—å£** (LoginWindow)
2. **å‘˜å·¥æ‰“å¡çª—å£** (CheckInWindow)
3. **ç®¡ç†å‘˜é…ç½®çª—å£** (AdminWindow)

### ä¸»é¢˜ç³»ç»Ÿ
- æ”¯æŒæµ…è‰²/æ·±è‰²ä¸»é¢˜è‡ªåŠ¨æ£€æµ‹
- ç»Ÿä¸€çš„é…è‰²æ–¹æ¡ˆ
- å“åº”å¼å¸ƒå±€

---

### 1. ç™»å½•/æ³¨å†Œçª—å£ (LoginWindow)

#### å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       å‘˜å·¥æ‰“å¡ç³»ç»Ÿ                    â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   ç™»å½•     â”‚   æ³¨å†Œ     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                      â”‚
â”‚  ç™»å½•æ ‡ç­¾é¡µï¼š                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ ç”¨æˆ·å: [_____________]  â”‚       â”‚
â”‚  â”‚ å¯†ç :   [_____________]  â”‚       â”‚
â”‚  â”‚                          â”‚       â”‚
â”‚  â”‚      [ ç™»å½• ]            â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                      â”‚
â”‚  æ³¨å†Œæ ‡ç­¾é¡µï¼š                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ ç”¨æˆ·å: [_____________]  â”‚       â”‚
â”‚  â”‚ å¯†ç :   [_____________]  â”‚       â”‚
â”‚  â”‚ å§“å:   [_____________]  â”‚       â”‚
â”‚  â”‚                          â”‚       â”‚
â”‚  â”‚      [ æ³¨å†Œ ]            â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### åŠŸèƒ½è¯´æ˜
- **ç™»å½•**ï¼š
  - è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
  - åå°å¼‚æ­¥éªŒè¯ï¼ˆä½¿ç”¨çº¿ç¨‹é¿å…UIå¡é¡¿ï¼‰
  - ç™»å½•æˆåŠŸåè·³è½¬åˆ°æ‰“å¡çª—å£
  - ä¿å­˜ç™»å½•çŠ¶æ€åˆ°æœ¬åœ° session.jsonï¼ˆç”¨äºè‡ªåŠ¨ç™»å½•ï¼‰

- **æ³¨å†Œ**ï¼š
  - è¾“å…¥ç”¨æˆ·åã€å¯†ç ã€çœŸå®å§“å
  - å¯†ç è‡ªåŠ¨ SHA256 å“ˆå¸Œ
  - é¦–æ¬¡æ³¨å†Œçš„ç”¨æˆ·é»˜è®¤ä¸ºæ™®é€šå‘˜å·¥ï¼ˆéç®¡ç†å‘˜ï¼‰

#### äº¤äº’ç»†èŠ‚
1. çª—å£å±…ä¸­æ˜¾ç¤º
2. è¾“å…¥æ¡†ç„¦ç‚¹åˆ‡æ¢
3. å›è½¦é”®æäº¤è¡¨å•
4. å¼‚æ­¥ç½‘ç»œè¯·æ±‚ï¼ˆæ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼‰
5. é”™è¯¯æç¤ºå±…ä¸­å¼¹çª—

---

### 2. å‘˜å·¥æ‰“å¡çª—å£ (CheckInWindow)

#### å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ å¼ ä¸‰        ğŸ“Š æˆ‘çš„ç»Ÿè®¡  ğŸ”„ åˆ·æ–°  âš™ï¸ç³»ç»Ÿé…ç½®  ğŸšªé€€å‡ºç™»å½•    â”‚
â”‚                                    2025-12-22 14:30:25 é‡‘è¾¹   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š å½“å‰çŠ¶æ€: âœ… å·¥ä½œä¸­ | â³ åˆé¤                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å¿«é€Ÿæ‰“å¡ã€‘                                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”             â”‚
â”‚ â”‚ä¸Šç­â”‚  â”‚[åˆé¤] [å¼€ä¼š] [æ‰“ç”µè¯]       â”‚  â”‚ä¸‹ç­â”‚             â”‚
â”‚ â”‚    â”‚  â”‚[ä¸Šå•æ‰€] [å‡ºå·®] [å¤–å‡º]       â”‚  â”‚å›åº§â”‚             â”‚
â”‚ â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜             â”‚
â”‚  (1åŒº)            (äº‹ä»¶åŒº)                (2åŒº)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€ä»Šæ—¥æ‰“å¡è®°å½•ã€‘                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ â”‚ ä¸Šç­    09:05  âœ… å·²å®Œæˆ  å·¥ä½œæ—¶é•¿: 5å°æ—¶25åˆ†       â”‚      â”‚
â”‚ â”‚ åˆé¤    12:00  âœ… å·²å®Œæˆ  æ—¶é•¿: 45åˆ†é’Ÿ              â”‚      â”‚
â”‚ â”‚ å›åº§    12:45  âœ… å·²å®Œæˆ                            â”‚      â”‚
â”‚ â”‚ å¼€ä¼š    14:00  â³ è¿›è¡Œä¸­  å·²ç”¨æ—¶: 30åˆ†é’Ÿ            â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

##### 1) é¡¶éƒ¨ä¿¡æ¯æ 
- **ç”¨æˆ·ä¿¡æ¯**ï¼šæ˜¾ç¤ºå½“å‰ç™»å½•ç”¨æˆ·çš„å§“å
- **åŠŸèƒ½æŒ‰é’®**ï¼š
  - `ğŸ“Š æˆ‘çš„ç»Ÿè®¡`ï¼šæŸ¥çœ‹ä¸ªäººæœˆåº¦è€ƒå‹¤ç»Ÿè®¡
  - `ğŸ”„ åˆ·æ–°`ï¼šä»æ•°æ®åº“é‡æ–°åŠ è½½æ•°æ®
  - `âš™ï¸ ç³»ç»Ÿé…ç½®`ï¼šæ‰“å¼€ç®¡ç†å‘˜é¢æ¿ï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰
  - `ğŸšª é€€å‡ºç™»å½•`ï¼šé€€å‡ºå¹¶è¿”å›ç™»å½•ç•Œé¢
- **å½“å‰æ—¶é—´**ï¼šå®æ—¶æ˜¾ç¤ºå…¬å¸æ—¶åŒºçš„å½“å‰æ—¶é—´ï¼ˆæ¯ç§’æ›´æ–°ï¼‰

##### 2) çŠ¶æ€å¡ç‰‡
æ˜¾ç¤ºå½“å‰å·¥ä½œçŠ¶æ€ï¼š
- `æœªä¸Šç­`ï¼šè¿˜æœªæ‰“ä¸Šç­å¡
- `âœ… å·¥ä½œä¸­`ï¼šå·²ä¸Šç­ä½†æœªä¸‹ç­
- `âœ… å·¥ä½œä¸­ | â³ åˆé¤`ï¼šä¸Šç­ä¸­ä¸”åœ¨è¿›è¡Œä¸´æ—¶äº‹ä»¶

##### 3) å¿«é€Ÿæ‰“å¡æŒ‰é’®åŒº
**å¸ƒå±€è§„åˆ™**ï¼š
- **å·¦åˆ—ï¼ˆ1åŒºï¼‰**ï¼šè¿›ç¨‹å¼€å§‹æŒ‰é’®ï¼ˆaction_role=1ï¼‰ï¼Œå¦‚"ä¸Šç­"
- **ä¸­åˆ—ï¼ˆäº‹ä»¶åŒºï¼‰**ï¼šäº‹ä»¶å¼€å§‹æŒ‰é’®ï¼ˆaction_role=3ï¼‰ï¼Œæ”¯æŒå¤šè¡Œç½‘æ ¼å¸ƒå±€ï¼ˆæ¯è¡Œæœ€å¤š4ä¸ªï¼‰
- **å³åˆ—ï¼ˆ2åŒºï¼‰**ï¼šè¿›ç¨‹/äº‹ä»¶ç»“æŸæŒ‰é’®ï¼ˆaction_role=2æˆ–4ï¼‰ï¼Œå¦‚"ä¸‹ç­"ã€"å›åº§"

**æŒ‰é’®çŠ¶æ€**ï¼š
- æŒ‰é’®é¢œè‰²ï¼šç”± action_types.button_color å†³å®š
- æŒ‰é’®æ–‡å­—ï¼šç”± action_types.button_text å†³å®š
- ç¦ç”¨çŠ¶æ€ï¼šæ ¹æ®ä¸šåŠ¡è§„åˆ™åŠ¨æ€å¯ç”¨/ç¦ç”¨ï¼ˆè§ä¸šåŠ¡é€»è¾‘ç« èŠ‚ï¼‰

**ç‚¹å‡»äº¤äº’**ï¼š
1. ç‚¹å‡»æŒ‰é’®ç«‹å³ç¦ç”¨å¹¶æ”¹ä¸º"âœ“ å·²æ‰“å¡"
2. ç«‹å³å¼¹å‡ºæˆåŠŸæç¤ºæ¡†ï¼ˆåŒ…å«æ—¶é—´ã€è¿Ÿåˆ°è­¦å‘Šç­‰ï¼‰
3. ç«‹å³æ›´æ–°UIè®°å½•åˆ—è¡¨ï¼ˆä¹è§‚æ›´æ–°ï¼‰
4. åå°å¼‚æ­¥åŒæ­¥æ•°æ®åº“
5. åŒæ­¥æˆåŠŸ/å¤±è´¥åæ›´æ–°çŠ¶æ€å›¾æ ‡

##### 4) ä»Šæ—¥æ‰“å¡è®°å½•
æ˜¾ç¤ºä»Šæ—¥ï¼ˆæœ€è¿‘24å°æ—¶ï¼‰çš„æ‰“å¡è®°å½•ï¼ŒæŒ‰æ—¶é—´å€’åºï¼š
- **è®°å½•å¡ç‰‡**ï¼š
  - æ‰“å¡ç±»å‹ï¼ˆé¢œè‰²æ ‡è¯†ï¼‰
  - æ‰“å¡æ—¶é—´
  - çŠ¶æ€ï¼ˆâ³è¿›è¡Œä¸­ / âœ…å·²å®Œæˆ / â°è¶…æ—¶ï¼‰
  - æ—¶é•¿ä¿¡æ¯ï¼ˆå¦‚é€‚ç”¨ï¼‰
  - è¿Ÿåˆ°æ ‡è®°ï¼ˆâš ï¸è¿Ÿåˆ° XX åˆ†é’Ÿï¼‰

- **å®æ—¶æ›´æ–°**ï¼š
  - è¿›è¡Œä¸­çš„è®°å½•æ˜¾ç¤ºå®æ—¶å€’è®¡æ—¶
  - è¶…æ—¶è‡ªåŠ¨æ ‡è®°ä¸ºçº¢è‰²

---

### 3. ç®¡ç†å‘˜é…ç½®çª—å£ (AdminWindow)

#### å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”§ ç³»ç»Ÿç®¡ç†é¢æ¿                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚ â”‚æ‰“å¡  â”‚æ—¶é—´  â”‚å‘˜å·¥  â”‚æ‰“å¡  â”‚ç»Ÿè®¡  â”‚                        â”‚
â”‚ â”‚ç±»å‹  â”‚è§„åˆ™  â”‚ç®¡ç†  â”‚è®°å½•  â”‚æŠ¥è¡¨  â”‚                        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                               â”‚
â”‚ [å½“å‰é€‰ä¸­æ ‡ç­¾é¡µçš„å†…å®¹]                                        â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ ‡ç­¾é¡µè¯¦æƒ…

##### 1) æ‰“å¡ç±»å‹ç®¡ç†
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â• æ·»åŠ æ‰“å¡äº‹ä»¶]  [ğŸ”„ åˆ·æ–°]                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ID â”‚ æŒ‰é’®æ–‡å­— â”‚ é¢œè‰²  â”‚ é™æ—¶(åˆ†é’Ÿ) â”‚ çŠ¶æ€ â”‚ æ“ä½œ           â”‚
â”‚ 1  â”‚ ä¸Šç­     â”‚ ğŸŸ¢   â”‚ -          â”‚ âœ…   â”‚ [ç¼–è¾‘]         â”‚
â”‚ 2  â”‚ ä¸‹ç­     â”‚ ğŸ”´   â”‚ -          â”‚ âœ…   â”‚ [ç¼–è¾‘]         â”‚
â”‚ 3  â”‚ åˆé¤     â”‚ ğŸŸ    â”‚ 60         â”‚ âœ…   â”‚ [ç¼–è¾‘] [åˆ é™¤]  â”‚
â”‚ 4  â”‚ å¼€ä¼š     â”‚ ğŸŸ£   â”‚ 120        â”‚ âœ…   â”‚ [ç¼–è¾‘] [åˆ é™¤]  â”‚
â”‚ 5  â”‚ å›åº§     â”‚ âš«   â”‚ -          â”‚ âœ…   â”‚ [ç¼–è¾‘]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ’¡ æç¤ºï¼šç³»ç»Ÿé»˜è®¤çš„æ‰“å¡ç±»å‹ï¼ˆä¸Šç­ã€ä¸‹ç­ã€å›åº§ï¼‰ä¸å¯åˆ é™¤
```

**åŠŸèƒ½**ï¼š
- **æ·»åŠ äº‹ä»¶**ï¼šå¼¹å‡ºå¯¹è¯æ¡†ï¼Œè¾“å…¥æŒ‰é’®æ ‡é¢˜ã€é€‰æ‹©é¢œè‰²ã€è®¾ç½®é™æ—¶æ—¶é—´
- **ç¼–è¾‘**ï¼šä¿®æ”¹æŒ‰é’®æ–‡å­—ã€é¢œè‰²ã€å¯ç”¨/ç¦ç”¨çŠ¶æ€
- **åˆ é™¤**ï¼šåˆ é™¤è‡ªå®šä¹‰äº‹ä»¶ï¼ˆç³»ç»Ÿé»˜è®¤ç±»å‹ä¸å¯åˆ é™¤ï¼‰

**æ·»åŠ äº‹ä»¶å¯¹è¯æ¡†**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ æ‰“å¡äº‹ä»¶         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŒ‰é’®æ ‡é¢˜: [______]   â”‚
â”‚ é™æ—¶æ—¶é—´: [30] åˆ†é’Ÿ  â”‚
â”‚ æŒ‰é’®é¢œè‰²: [ğŸŸ ] [é€‰æ‹©]â”‚
â”‚                      â”‚
â”‚   [å–æ¶ˆ]  [ç¡®å®šæ·»åŠ ] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### 2) æ—¶é—´è§„åˆ™ç®¡ç†
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â° é…ç½®ä¸Šä¸‹ç­æ—¶é—´ã€è¿Ÿåˆ°æ—©é€€å®¹å¿åº¦ã€äº‹ä»¶æ—¶é•¿é™åˆ¶ç­‰                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [â• æ·»åŠ è§„åˆ™]  [ğŸ”„ åˆ·æ–°]                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è§„åˆ™åç§°       â”‚ æ‰“å¡ç±»å‹ â”‚ æœŸæœ›æ—¶é—´ â”‚ å…è®¸æ—©åˆ° â”‚ å…è®¸è¿Ÿåˆ° â”‚ æ“ä½œâ”‚
â”‚ ä¸Šç­æ—¶é—´è§„åˆ™   â”‚ ä¸Šç­     â”‚ 09:00    â”‚ 30åˆ†é’Ÿ   â”‚ 15åˆ†é’Ÿ   â”‚[ç¼–è¾‘]â”‚
â”‚ ä¸‹ç­æ—¶é—´è§„åˆ™   â”‚ ä¸‹ç­     â”‚ 18:00    â”‚ -        â”‚ -        â”‚[ç¼–è¾‘]â”‚
â”‚ åˆé¤æ—¶é•¿é™åˆ¶   â”‚ åˆé¤     â”‚ -        â”‚ -        â”‚ -        â”‚[ç¼–è¾‘]â”‚
â”‚                â”‚          â”‚          â”‚  (æœ€é•¿60åˆ†é’Ÿ)         â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½**ï¼š
- **æ·»åŠ è§„åˆ™**ï¼šä¸ºæŒ‡å®šæ‰“å¡ç±»å‹é…ç½®æ—¶é—´è§„åˆ™
- **ç¼–è¾‘è§„åˆ™**ï¼šä¿®æ”¹æœŸæœ›æ—¶é—´ã€å®¹å¿åº¦ã€æ—¶é•¿é™åˆ¶ç­‰

##### 3) å‘˜å·¥ç®¡ç†
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ”„ åˆ·æ–°]                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ID â”‚ ç”¨æˆ·å  â”‚ å§“å   â”‚ ç®¡ç†å‘˜ â”‚ æ“ä½œ                   â”‚
â”‚ 1  â”‚ admin   â”‚ ç®¡ç†å‘˜ â”‚ âœ…     â”‚ [é‡ç½®å¯†ç ] [åˆ é™¤]      â”‚
â”‚ 2  â”‚ zhangsanâ”‚ å¼ ä¸‰   â”‚ âŒ     â”‚ [è®¾ä¸ºç®¡ç†å‘˜] [åˆ é™¤]    â”‚
â”‚ 3  â”‚ lisi    â”‚ æå››   â”‚ âŒ     â”‚ [è®¾ä¸ºç®¡ç†å‘˜] [åˆ é™¤]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½**ï¼š
- **æŸ¥çœ‹å‘˜å·¥åˆ—è¡¨**
- **åˆ é™¤å‘˜å·¥**ï¼šåˆ é™¤å‘˜å·¥åŠå…¶æ‰€æœ‰æ‰“å¡è®°å½•
- **è®¾ç½®ç®¡ç†å‘˜æƒé™**

##### 4) æ‰“å¡è®°å½•æŸ¥è¯¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŸ¥è¯¢æ¡ä»¶                                                     â”‚
â”‚ æ—¥æœŸèŒƒå›´: [2025-12-15] è‡³ [2025-12-22]                      â”‚
â”‚ å‘˜å·¥: [å…¨éƒ¨ â–¼]    [ğŸ” æŸ¥è¯¢]                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å‘˜å·¥ â”‚ æ‰“å¡ç±»å‹ â”‚ æ‰“å¡æ—¶é—´      â”‚ çŠ¶æ€ â”‚ æ—¶é•¿  â”‚ è¿Ÿåˆ° â”‚ å¤‡æ³¨â”‚
â”‚ å¼ ä¸‰ â”‚ ä¸Šç­     â”‚ 2025-12-22... â”‚ å®Œæˆ â”‚ 480  â”‚ âŒ   â”‚     â”‚
â”‚ å¼ ä¸‰ â”‚ åˆé¤     â”‚ 2025-12-22... â”‚ å®Œæˆ â”‚ 45   â”‚ âŒ   â”‚     â”‚
â”‚ æå›› â”‚ ä¸Šç­     â”‚ 2025-12-22... â”‚ å®Œæˆ â”‚ 500  â”‚ âš ï¸   â”‚è¿Ÿåˆ°â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½**ï¼š
- **æŒ‰æ—¥æœŸèŒƒå›´æŸ¥è¯¢**
- **æŒ‰å‘˜å·¥ç­›é€‰**
- **æŸ¥çœ‹è¯¦ç»†æ‰“å¡è®°å½•**

##### 5) ç»Ÿè®¡æŠ¥è¡¨
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é€‰æ‹©æœˆä»½: [2025-12 â–¼]  [ğŸ“Š ç”ŸæˆæŠ¥è¡¨]  [ğŸ“¥ å¯¼å‡ºExcel]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€2025å¹´12æœˆè€ƒå‹¤ç»Ÿè®¡ã€‘                                       â”‚
â”‚                                                              â”‚
â”‚ æ€»å‡ºå‹¤å¤©æ•°: 20å¤©                                             â”‚
â”‚ æ€»å·¥ä½œæ—¶é•¿: 160å°æ—¶                                          â”‚
â”‚ å¹³å‡æ¯å¤©: 8å°æ—¶                                              â”‚
â”‚ è¿Ÿåˆ°æ¬¡æ•°: 2æ¬¡                                                â”‚
â”‚ æ€»è¿Ÿåˆ°æ—¶é•¿: 35åˆ†é’Ÿ                                           â”‚
â”‚                                                              â”‚
â”‚ è¯¦ç»†è®°å½•ï¼š                                                   â”‚
â”‚ æ—¥æœŸ       â”‚ ä¸Šç­   â”‚ ä¸‹ç­   â”‚ å·¥ä½œæ—¶é•¿ â”‚ è¿Ÿåˆ°              â”‚
â”‚ 2025-12-01 â”‚ 09:00  â”‚ 18:00  â”‚ 8.0å°æ—¶  â”‚ âŒ                â”‚
â”‚ 2025-12-02 â”‚ 09:15  â”‚ 18:10  â”‚ 7.9å°æ—¶  â”‚ âš ï¸ è¿Ÿåˆ°15åˆ†é’Ÿ   â”‚
â”‚ ...                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½**ï¼š
- **é€‰æ‹©ç»Ÿè®¡æœˆä»½**
- **ç”Ÿæˆç»Ÿè®¡æŠ¥è¡¨**ï¼ˆå·¥ä½œå¤©æ•°ã€æ€»æ—¶é•¿ã€è¿Ÿåˆ°ç»Ÿè®¡ï¼‰
- **å¯¼å‡ºExcel**ï¼šç”Ÿæˆ .xlsx æ–‡ä»¶

---

## ğŸ”„ ä¸šåŠ¡é€»è¾‘ä¸è§„åˆ™

### æ ¸å¿ƒå·¥ä½œæµç¨‹

#### 1. æ‰“å¡è§„åˆ™ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰

ç³»ç»Ÿé€šè¿‡ `action_role` å­—æ®µåŒºåˆ†ä¸åŒç±»å‹çš„æ‰“å¡åŠ¨ä½œï¼š

| action_role | ç±»å‹         | è¯´æ˜                           | ç¤ºä¾‹          |
|-------------|--------------|--------------------------------|---------------|
| 1           | è¿›ç¨‹å¼€å§‹     | å¼€å§‹ä¸€ä¸ªå·¥ä½œå‘¨æœŸ               | ä¸Šç­          |
| 2           | è¿›ç¨‹ç»“æŸ     | ç»“æŸå·¥ä½œå‘¨æœŸ                   | ä¸‹ç­          |
| 3           | äº‹ä»¶å¼€å§‹     | ä¸´æ—¶äº‹ä»¶å¼€å§‹                   | åˆé¤ã€å¼€ä¼š    |
| 4           | äº‹ä»¶ç»“æŸ     | ä¸´æ—¶äº‹ä»¶ç»“æŸ                   | å›åº§          |

##### æ‰“å¡è§„åˆ™çŸ©é˜µ

```
å½“å‰çŠ¶æ€           | å¯ä»¥æ‰“å¡çš„ç±»å‹
-------------------|--------------------------------------------------
æœªä¸Šç­             | âœ… ä¸Šç­(1)  âŒ ä¸‹ç­  âŒ äº‹ä»¶  âŒ å›åº§
å·¥ä½œä¸­(æ— äº‹ä»¶)     | âŒ ä¸Šç­     âŒ ä¸‹ç­  âœ… äº‹ä»¶  âŒ å›åº§
å·¥ä½œä¸­(æœ‰äº‹ä»¶)     | âŒ ä¸Šç­     âŒ ä¸‹ç­  âŒ äº‹ä»¶  âœ… å›åº§
å·¥ä½œä¸­(å›åº§å)     | âŒ ä¸Šç­     âœ… ä¸‹ç­  âœ… äº‹ä»¶  âŒ å›åº§
```

**è¯¦ç»†è§„åˆ™**ï¼š

1. **æ‰“"ä¸Šç­"å¡ï¼ˆrole=1ï¼‰**ï¼š
   - âœ… å…è®¸æ¡ä»¶ï¼š
     - æ²¡æœ‰è¿›è¡Œä¸­çš„å·¥ä½œè¿›ç¨‹
     - æ²¡æœ‰è¿›è¡Œä¸­çš„äº‹ä»¶
   - âŒ ä¸å…è®¸æ¡ä»¶ï¼š
     - å·²ç»åœ¨å·¥ä½œä¸­ï¼ˆæœ‰æœªå®Œæˆçš„ä¸Šç­è®°å½•ï¼‰
     - æœ‰æœªå®Œæˆçš„äº‹ä»¶ï¼ˆéœ€å…ˆ"å›åº§"ï¼‰
   - ğŸ“ æ•ˆæœï¼š
     - åˆ›å»ºä¸€æ¡ status=ongoing çš„è®°å½•
     - æŒ‰é’®å˜ä¸ºç¦ç”¨çŠ¶æ€

2. **æ‰“"ä¸‹ç­"å¡ï¼ˆrole=2ï¼‰**ï¼š
   - âœ… å…è®¸æ¡ä»¶ï¼š
     - å·²ç»ä¸Šç­ï¼ˆæœ‰è¿›è¡Œä¸­çš„ä¸Šç­è®°å½•ï¼‰
     - æ²¡æœ‰è¿›è¡Œä¸­çš„äº‹ä»¶ï¼ˆæ‰€æœ‰äº‹ä»¶éƒ½å·²"å›åº§"ï¼‰
   - âŒ ä¸å…è®¸æ¡ä»¶ï¼š
     - è¿˜æœªä¸Šç­
     - æœ‰æœªå®Œæˆçš„äº‹ä»¶
   - ğŸ“ æ•ˆæœï¼š
     - åˆ›å»ºä¸€æ¡ status=completed çš„è®°å½•
     - æ›´æ–°å¯¹åº”çš„ä¸Šç­è®°å½•ä¸º status=completed
     - è®¡ç®—å·¥ä½œæ—¶é•¿å¹¶å­˜å‚¨åˆ° duration_minutes

3. **æ‰“"äº‹ä»¶å¼€å§‹"å¡ï¼ˆrole=3ï¼‰**ï¼š
   - âœ… å…è®¸æ¡ä»¶ï¼š
     - å·²ç»ä¸Šç­ï¼ˆæœ‰è¿›è¡Œä¸­çš„å·¥ä½œè¿›ç¨‹ï¼‰
     - æ²¡æœ‰å…¶ä»–è¿›è¡Œä¸­çš„äº‹ä»¶ï¼ˆäº‹ä»¶äº’æ–¥ï¼Œä¸€æ¬¡åªèƒ½ä¸€ä¸ªï¼‰
   - âŒ ä¸å…è®¸æ¡ä»¶ï¼š
     - è¿˜æœªä¸Šç­
     - å·²æœ‰å…¶ä»–äº‹ä»¶åœ¨è¿›è¡Œä¸­
   - ğŸ“ æ•ˆæœï¼š
     - åˆ›å»ºä¸€æ¡ status=ongoing çš„è®°å½•
     - å¦‚æœæœ‰æ—¶é—´é™åˆ¶ï¼Œå¼€å§‹è®¡æ—¶

4. **æ‰“"å›åº§"å¡ï¼ˆrole=4ï¼‰**ï¼š
   - âœ… å…è®¸æ¡ä»¶ï¼š
     - æœ‰è¿›è¡Œä¸­çš„äº‹ä»¶
   - âŒ ä¸å…è®¸æ¡ä»¶ï¼š
     - æ²¡æœ‰è¿›è¡Œä¸­çš„äº‹ä»¶
   - ğŸ“ æ•ˆæœï¼š
     - åˆ›å»ºä¸€æ¡ status=completed çš„è®°å½•
     - æ›´æ–°å¯¹åº”çš„äº‹ä»¶è®°å½•ä¸º status=completed æˆ– status=overtime
     - è®¡ç®—äº‹ä»¶æ—¶é•¿å¹¶å­˜å‚¨

---

#### 2. é…å¯¹æœºåˆ¶

**é…å¯¹å…³ç³»**ï¼š
- ä¸Šç­(1) â†” ä¸‹ç­(2)
- äº‹ä»¶å¼€å§‹(3) â†” å›åº§(4)

**é…å¯¹æµç¨‹**ï¼š
```
ç”¨æˆ·ç‚¹å‡»"ä¸Šç­" â†’ åˆ›å»ºè®°å½•A (status=ongoing, pair_check_in_id=NULL)
   â†“
[å·¥ä½œä¸­...]
   â†“
ç”¨æˆ·ç‚¹å‡»"ä¸‹ç­" â†’ åˆ›å»ºè®°å½•B (status=completed, pair_check_in_id=A.id)
   â†“
åŒæ—¶æ›´æ–°è®°å½•A:
  - status = completed
  - pair_check_in_id = B.id
  - duration_minutes = (B.check_time - A.check_time) / 60
```

---

#### 3. è¿Ÿåˆ°æ£€æµ‹

**æ£€æµ‹æ—¶æœº**ï¼š
- æ‰“å¡æ—¶ç«‹å³æ£€æµ‹ï¼ˆå‰ç«¯æœ¬åœ°è®¡ç®— + åç«¯äºŒæ¬¡ç¡®è®¤ï¼‰

**æ£€æµ‹é€»è¾‘**ï¼š

1. **è·å–æ—¶é—´è§„åˆ™**ï¼š
   ```sql
   SELECT * FROM time_rules 
   WHERE action_type_id = ? AND is_active = TRUE
   ```

2. **è®¡ç®—æ˜¯å¦è¿Ÿåˆ°**ï¼š
   ```javascript
   // ç¤ºä¾‹ï¼šä¸Šç­æ—¶é—´ 09:00ï¼Œå…è®¸è¿Ÿåˆ° 15 åˆ†é’Ÿ
   const expectedTime = "09:00:00";
   const allowLateMinutes = 15;
   const checkTime = "09:20:00"; // æ‰“å¡æ—¶é—´
   
   // è®¡ç®—å·®å€¼
   const diffMinutes = (checkTime - expectedTime) / 60;
   
   if (diffMinutes > allowLateMinutes) {
       isLate = true;
       lateMinutes = diffMinutes - allowLateMinutes; // 5åˆ†é’Ÿ
       reason = `è¿Ÿåˆ°${lateMinutes}åˆ†é’Ÿ`;
   }
   ```

3. **è·¨æ—¥å·¥ä½œå‘¨æœŸå¤„ç†**ï¼š
   
   **åœºæ™¯**ï¼šå…¬å¸å·¥ä½œæ—¶é—´ä¸º 12:00 - 03:00ï¼ˆè·¨å¤œç­ï¼‰
   
   ```
   æ—¶é—´è½´:
   æ˜¨å¤©              ä»Šå¤©
   ...12:00-------00:00-------03:00-------12:00...
       â†‘ä¸Šç­               â†‘ä¸‹ç­       â†‘ä¸Šç­
       
   å·¥ä½œå‘¨æœŸ: æ˜¨å¤©12:00 â†’ ä»Šå¤©03:00
   ä¼‘æ¯çª—å£: ä»Šå¤©03:00 â†’ ä»Šå¤©12:00
   ```
   
   **åˆ¤æ–­é€»è¾‘**ï¼š
   ```javascript
   const onTime = "12:00";   // ä¸Šç­æ—¶é—´
   const offTime = "03:00";  // ä¸‹ç­æ—¶é—´
   const checkTime = "01:30"; // æ‰“å¡æ—¶é—´
   
   // åˆ¤æ–­æ˜¯å¦è·¨æ—¥
   const isCrossDay = (offTime < onTime);
   
   if (isCrossDay) {
       if (checkTime <= offTime) {
           // å‡Œæ™¨æ—¶æ®µ (00:00-03:00)
           // å±äº"æ˜¨å¤©çš„å·¥ä½œå‘¨æœŸ"
           // åº”è¯¥æ˜¨å¤©12:00ä¸Šç­ï¼Œç°åœ¨ä¸¥é‡è¿Ÿåˆ°
           expectedDate = yesterday;
           isLate = true;
       } else if (checkTime < onTime) {
           // ä¼‘æ¯çª—å£ (03:00-12:00)
           // æå‰æ‰“å¡ä¸ç®—è¿Ÿåˆ°
           isLate = false;
       } else {
           // ä¸Šç­æ—¶é—´ä¹‹å (12:00ä¹‹å)
           // æ­£å¸¸æ£€æµ‹è¿Ÿåˆ°
           checkNormal();
       }
   }
   ```

4. **ç»“æœ**ï¼š
   - å°† `is_late` å­—æ®µå­˜å…¥æ•°æ®åº“
   - åœ¨UIæ˜¾ç¤ºè¿Ÿåˆ°è­¦å‘Š

---

#### 4. è¶…æ—¶æ£€æµ‹

**æ£€æµ‹å¯¹è±¡**ï¼šäº‹ä»¶ç±»å‹ï¼ˆrole=3ï¼‰

**æ£€æµ‹é€»è¾‘**ï¼š
```javascript
// ä»æ—¶é—´è§„åˆ™è·å–
const maxDuration = 60; // åˆé¤æœ€é•¿60åˆ†é’Ÿ
const warningMinutes = 48; // 48åˆ†é’Ÿæ—¶æé†’

// è®¡ç®—å·²ç”¨æ—¶é•¿
const elapsed = (currentTime - eventStartTime) / 60;

if (elapsed >= maxDuration) {
    status = "overtime"; // è¶…æ—¶
    alert("åˆé¤æ—¶é—´å·²è¶…è¿‡é™åˆ¶ï¼");
} else if (elapsed >= warningMinutes) {
    status = "ongoing";
    alert("åˆé¤æ—¶é—´å³å°†åˆ°è¾¾é™åˆ¶ï¼Œè¯·å°½å¿«å›åº§ï¼");
}
```

---

#### 5. é›¶å»¶è¿ŸUIæ›´æ–°ï¼ˆä¹è§‚æ›´æ–°ç­–ç•¥ï¼‰

**é—®é¢˜**ï¼šç½‘ç»œè¯·æ±‚éœ€è¦æ—¶é—´ï¼Œç”¨æˆ·ä½“éªŒå·®

**è§£å†³æ–¹æ¡ˆ**ï¼šå‰ç«¯ä¹è§‚æ›´æ–° + åå°å¼‚æ­¥åŒæ­¥

```javascript
// ç‚¹å‡»æ‰“å¡æŒ‰é’®
function handleCheckIn(actionType) {
    // 1. ç«‹å³éªŒè¯è§„åˆ™ï¼ˆåŸºäºå‰ç«¯ç¼“å­˜ï¼‰
    const allowed = validateRules(actionType);
    if (!allowed) {
        showError("æ“ä½œä¸å…è®¸");
        return;
    }
    
    // 2. ç«‹å³æ›´æ–°UIï¼ˆ0å»¶è¿Ÿï¼‰
    const localRecord = {
        id: `local_${Date.now()}`,
        action_type_id: actionType.id,
        check_time: getCurrentTime(),
        status: 'ongoing',
        synced: false
    };
    
    // æ·»åŠ åˆ°UIè®°å½•åˆ—è¡¨
    uiRecords.unshift(localRecord);
    
    // ç¦ç”¨æŒ‰é’®
    disableButton(actionType.id);
    
    // æ˜¾ç¤ºæˆåŠŸæç¤º
    showSuccess("æ‰“å¡æˆåŠŸï¼");
    
    // 3. åå°å¼‚æ­¥åŒæ­¥æ•°æ®åº“
    syncToDatabase(localRecord).then(result => {
        // æ›´æ–°æœ¬åœ°è®°å½•çš„çœŸå®ID
        updateLocalRecord(localRecord.id, result.id);
        localRecord.synced = true;
    }).catch(error => {
        // åŒæ­¥å¤±è´¥ï¼šæç¤ºç”¨æˆ·ï¼Œä½†ä¸å›æ»šUI
        showWarning("æ•°æ®åŒæ­¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ");
    });
}
```

**ä¼˜ç‚¹**ï¼š
- ç”¨æˆ·ç‚¹å‡»åç«‹å³çœ‹åˆ°åé¦ˆï¼ˆ0å»¶è¿Ÿï¼‰
- å³ä½¿ç½‘ç»œæ…¢ä¹Ÿä¸å½±å“ä½“éªŒ
- å¤±è´¥æ—¶ä¸ä¸¢å¤±æ•°æ®ï¼ˆå¯é‡è¯•ï¼‰

---

### æ—¶åŒºå¤„ç†

**æ ¸å¿ƒåŸåˆ™**ï¼š
- **ç»Ÿä¸€æ—¶åŒº**ï¼šæ‰€æœ‰å‘˜å·¥æ‰“å¡ä½¿ç”¨å…¬å¸æ—¶åŒºï¼ˆå¦‚ Asia/Phnom_Penhï¼‰
- **æ— æ—¶åŒºå­˜å‚¨**ï¼šæ•°æ®åº“ä¸­ç›´æ¥å­˜å‚¨å…¬å¸æ—¶åŒºçš„æ—¶é—´ï¼ˆä¸å¸¦æ—¶åŒºæ ‡è®°ï¼‰
- **å‰ç«¯æ˜¾ç¤º**ï¼šæ˜¾ç¤ºæ—¶æ ‡æ³¨æ—¶åŒº

**å®ç°**ï¼š
```javascript
// è·å–å…¬å¸æ—¶åŒºçš„å½“å‰æ—¶é—´
function getCompanyTime() {
    const companyTimezone = "Asia/Phnom_Penh";
    return moment.tz(companyTimezone);
}

// å­˜å‚¨åˆ°æ•°æ®åº“
function saveCheckIn() {
    const checkTime = getCompanyTime().format("YYYY-MM-DD HH:mm:ss");
    // ç›´æ¥å­˜å‚¨ï¼Œæ— æ—¶åŒºæ ‡è®°
    db.insert({ check_time: checkTime });
}

// æ˜¾ç¤ºåœ¨UI
function displayTime(checkTimeStr) {
    // æ˜¾ç¤ºæ—¶æ ‡æ³¨æ—¶åŒº
    return `${checkTimeStr} (é‡‘è¾¹)`;
}
```

---

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯è¦ç‚¹

### 1. å•å®ä¾‹æ£€æµ‹
**éœ€æ±‚**ï¼šé˜²æ­¢ç”¨æˆ·åŒæ—¶æ‰“å¼€å¤šä¸ªåº”ç”¨å®ä¾‹

**å®ç°æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ç³»ç»Ÿçº§å…±äº«å†…å­˜/æ–‡ä»¶é”
- åº”ç”¨å¯åŠ¨æ—¶æ£€æŸ¥é”
- å¦‚æœå·²æœ‰å®ä¾‹è¿è¡Œï¼Œæ˜¾ç¤ºè­¦å‘Šå¹¶é€€å‡º

**Tauri å®ç°**ï¼š
```rust
use single_instance::SingleInstance;

fn main() {
    let instance = SingleInstance::new("CheckInAppUniqueId").unwrap();
    if !instance.is_single() {
        // å·²æœ‰å®ä¾‹è¿è¡Œ
        show_dialog("ç¨‹åºå·²åœ¨è¿è¡Œ");
        return;
    }
    // ç»§ç»­å¯åŠ¨
}
```

### 2. ä¼šè¯æŒä¹…åŒ–
**éœ€æ±‚**ï¼šè®°ä½ç™»å½•çŠ¶æ€ï¼Œä¸‹æ¬¡å¯åŠ¨è‡ªåŠ¨ç™»å½•

**å®ç°æ–¹æ¡ˆ**ï¼š
- ç™»å½•æˆåŠŸåä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°æœ¬åœ°æ–‡ä»¶ï¼ˆJSONï¼‰
- å¯åŠ¨æ—¶è¯»å–å¹¶éªŒè¯
- å¦‚æœæœ‰æ•ˆåˆ™è·³è¿‡ç™»å½•ç•Œé¢

**å­˜å‚¨æ ¼å¼**ï¼š
```json
{
    "user_id": 123,
    "username": "zhangsan",
    "full_name": "å¼ ä¸‰",
    "is_admin": false,
    "last_login": "2025-12-22T14:30:00"
}
```

### 3. å¼‚æ­¥æ•°æ®åŠ è½½
**éœ€æ±‚**ï¼šé¿å…UIå¡é¡¿

**å®ç°æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨çº¿ç¨‹/å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢
- UIçº¿ç¨‹åªè´Ÿè´£æ˜¾ç¤ºå’Œäº¤äº’
- æ•°æ®åŠ è½½å®Œæˆåé€šè¿‡å›è°ƒæ›´æ–°UI

### 4. ä¸»é¢˜ç³»ç»Ÿ
**éœ€æ±‚**ï¼šæ”¯æŒæµ…è‰²/æ·±è‰²ä¸»é¢˜

**å®ç°æ–¹æ¡ˆ**ï¼š
- å®šä¹‰ä¸»é¢˜é…è‰²å¯¹è±¡
- æ£€æµ‹ç³»ç»Ÿä¸»é¢˜åå¥½
- åº”ç”¨åˆ°æ‰€æœ‰ç»„ä»¶

---

## ğŸ¦€ Rust åç«¯æ¶æ„ï¼ˆsrc-tauriï¼‰

### ç›®å½•ç»“æ„

```
src-tauri/
â”œâ”€â”€ Cargo.toml                   # Rust é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ tauri.conf.json             # Tauri åº”ç”¨é…ç½®
â”œâ”€â”€ build.rs                    # æ„å»ºè„šæœ¬
â”œâ”€â”€ icons/                      # åº”ç”¨å›¾æ ‡èµ„æº
â””â”€â”€ src/                        # Rust æºä»£ç 
    â”œâ”€â”€ main.rs                 # åº”ç”¨å…¥å£ï¼ˆæ³¨å†Œ Tauri å‘½ä»¤ï¼‰
    â”œâ”€â”€ commands/               # Tauri å‘½ä»¤å±‚ï¼ˆå‰ç«¯è°ƒç”¨çš„æ¥å£ï¼‰
    â”‚   â”œâ”€â”€ mod.rs             # å‘½ä»¤æ¨¡å—å¯¼å‡º
    â”‚   â”œâ”€â”€ auth.rs            # è®¤è¯ç›¸å…³å‘½ä»¤ï¼ˆç™»å½•ã€æ³¨å†Œï¼‰
    â”‚   â”œâ”€â”€ checkin.rs         # æ‰“å¡ç›¸å…³å‘½ä»¤ï¼ˆåˆ›å»ºæ‰“å¡ã€æŸ¥è¯¢è®°å½•ï¼‰
    â”‚   â”œâ”€â”€ admin.rs           # ç®¡ç†å‘˜å‘½ä»¤ï¼ˆç”¨æˆ·ç®¡ç†ã€é…ç½®ç®¡ç†ï¼‰
    â”‚   â””â”€â”€ statistics.rs      # ç»Ÿè®¡å‘½ä»¤ï¼ˆæŠ¥è¡¨ç”Ÿæˆï¼‰
    â”œâ”€â”€ database/               # æ•°æ®åº“å±‚ï¼ˆSupabase é€šä¿¡ï¼‰
    â”‚   â”œâ”€â”€ mod.rs             # æ•°æ®åº“æ¨¡å—å¯¼å‡º
    â”‚   â””â”€â”€ supabase.rs        # Supabase å®¢æˆ·ç«¯ï¼ˆHTTP è¯·æ±‚å°è£…ï¼‰
    â”œâ”€â”€ models/                 # æ•°æ®æ¨¡å‹ï¼ˆä¸æ•°æ®åº“è¡¨å¯¹åº”ï¼‰
    â”‚   â”œâ”€â”€ mod.rs             # æ¨¡å‹æ¨¡å—å¯¼å‡º
    â”‚   â”œâ”€â”€ user.rs            # ç”¨æˆ·æ¨¡å‹
    â”‚   â”œâ”€â”€ action_type.rs     # æ‰“å¡ç±»å‹æ¨¡å‹
    â”‚   â”œâ”€â”€ check_in.rs        # æ‰“å¡è®°å½•æ¨¡å‹
    â”‚   â””â”€â”€ time_rule.rs       # æ—¶é—´è§„åˆ™æ¨¡å‹
    â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
        â”œâ”€â”€ mod.rs             # å·¥å…·æ¨¡å—å¯¼å‡º
        â”œâ”€â”€ crypto.rs          # åŠ å¯†å·¥å…·ï¼ˆSHA256 å¯†ç å“ˆå¸Œï¼‰
        â””â”€â”€ time.rs            # æ—¶é—´å¤„ç†å·¥å…·ï¼ˆæ—¶åŒºè½¬æ¢ã€è¿Ÿåˆ°æ£€æµ‹ï¼‰
```

**æ¶æ„è¯´æ˜**ï¼š

1. **main.rs**ï¼šåº”ç”¨å…¥å£ï¼Œè´Ÿè´£ï¼š
   - åˆå§‹åŒ– Supabase å®¢æˆ·ç«¯
   - æ³¨å†Œæ‰€æœ‰ Tauri å‘½ä»¤
   - å¯åŠ¨åº”ç”¨

2. **commands/**ï¼šå‰ç«¯å¯è°ƒç”¨çš„å‘½ä»¤æ¥å£å±‚ï¼Œæ¯ä¸ªæ–‡ä»¶åŒ…å«ï¼š
   - `auth.rs`ï¼š`login`, `register`, `get_current_user`
   - `checkin.rs`ï¼š`create_check_in`, `get_today_check_ins`, `get_action_types`, `get_time_rules`
   - `admin.rs`ï¼š`get_all_users`, `update_user_admin_status`, `delete_user`, æ‰“å¡ç±»å‹å’Œæ—¶é—´è§„åˆ™çš„ CRUD
   - `statistics.rs`ï¼š`get_user_statistics`, `get_all_check_ins`

3. **database/**ï¼šæ•°æ®åº“é€šä¿¡å±‚
   - `supabase.rs`ï¼šå°è£… Supabase REST API è°ƒç”¨ï¼ˆGET, POST, PUT, DELETEï¼‰

4. **models/**ï¼šæ•°æ®ç»“æ„å®šä¹‰ï¼Œä¸æ•°æ®åº“è¡¨ä¸€ä¸€å¯¹åº”
   - ä½¿ç”¨ `serde` è¿›è¡Œåºåˆ—åŒ–/ååºåˆ—åŒ–
   - å®šä¹‰è¯·æ±‚å’Œå“åº”çš„æ•°æ®ç»“æ„

5. **utils/**ï¼šé€šç”¨å·¥å…·å‡½æ•°
   - `crypto.rs`ï¼šå¯†ç åŠ å¯†ï¼ˆSHA256ï¼‰
   - `time.rs`ï¼šæ—¶åŒºå¤„ç†ã€æ—¶é—´è®¡ç®—ã€è¿Ÿåˆ°æ£€æµ‹é€»è¾‘

---

## ğŸ“ API è®¾è®¡ï¼ˆRust Backendï¼‰

### Supabase é€šä¿¡æ¨¡å—

```rust
// database.rs

pub struct Database {
    base_url: String,
    api_key: String,
    client: reqwest::Client,
}

impl Database {
    // ç”¨æˆ·è®¤è¯
    pub async fn login_user(&self, username: &str, password: &str) -> Result<User>;
    pub async fn register_user(&self, username: &str, password: &str, full_name: &str) -> Result<User>;
    
    // æ‰“å¡ç±»å‹
    pub async fn get_action_types(&self, is_active: Option<bool>) -> Result<Vec<ActionType>>;
    pub async fn add_action_type(&self, data: ActionTypeData) -> Result<ActionType>;
    pub async fn update_action_type(&self, id: i32, data: ActionTypeData) -> Result<()>;
    pub async fn delete_action_type(&self, id: i32) -> Result<()>;
    
    // æ‰“å¡è®°å½•
    pub async fn add_check_in(&self, data: CheckInData) -> Result<CheckIn>;
    pub async fn get_check_ins(&self, user_id: i32, limit: Option<i32>) -> Result<Vec<CheckIn>>;
    pub async fn get_ongoing_check_ins(&self, user_id: i32) -> Result<Vec<CheckIn>>;
    pub async fn update_check_in_status(&self, id: i32, status: &str) -> Result<()>;
    pub async fn complete_paired_check_in(&self, start_id: i32, end_id: i32) -> Result<Duration>;
    
    // æ—¶é—´è§„åˆ™
    pub async fn get_time_rules(&self, is_active: Option<bool>) -> Result<Vec<TimeRule>>;
    pub async fn add_time_rule(&self, data: TimeRuleData) -> Result<TimeRule>;
    pub async fn update_time_rule(&self, id: i32, data: TimeRuleData) -> Result<()>;
    pub async fn check_if_late(&self, action_type_id: i32, check_time: &str) -> Result<LateCheck>;
    
    // ç»Ÿè®¡æŠ¥è¡¨
    pub async fn get_user_statistics(&self, user_id: i32, year: i32, month: i32) -> Result<Statistics>;
}
```

### Tauri Commands

```rust
// commands.rs

#[tauri::command]
async fn login(username: String, password: String) -> Result<User, String>;

#[tauri::command]
async fn get_action_types(is_active: Option<bool>) -> Result<Vec<ActionType>, String>;

#[tauri::command]
async fn check_in(user_id: i32, action_type_id: i32) -> Result<CheckInResult, String>;

#[tauri::command]
async fn get_today_records(user_id: i32) -> Result<Vec<CheckIn>, String>;

#[tauri::command]
async fn get_statistics(user_id: i32, year: i32, month: i32) -> Result<Statistics, String>;

// ... å…¶ä»–å‘½ä»¤
```

---

## ğŸ“¦ å‰ç«¯æ¶æ„ï¼ˆReact + TypeScriptï¼‰

### ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ App.tsx                      # ä¸»åº”ç”¨ç»„ä»¶
â”œâ”€â”€ main.tsx                     # å…¥å£æ–‡ä»¶
â”œâ”€â”€ vite-env.d.ts               # Vite ç¯å¢ƒç±»å‹å®šä¹‰
â”œâ”€â”€ types/                       # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ index.ts                # ç»Ÿä¸€å¯¼å‡ºçš„ç±»å‹å®šä¹‰ï¼ˆUser, ActionType, CheckIn, TimeRuleç­‰ï¼‰
â”‚   â””â”€â”€ database.types.ts       # Supabase æ•°æ®åº“ç±»å‹å®šä¹‰ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ components/                  # å…¬å…±ç»„ä»¶
â”‚   â””â”€â”€ common/                 # é€šç”¨ç»„ä»¶
â”‚       â”œâ”€â”€ Button.tsx          # æŒ‰é’®ç»„ä»¶
â”‚       â”œâ”€â”€ Card.tsx            # å¡ç‰‡ç»„ä»¶
â”‚       â”œâ”€â”€ Input.tsx           # è¾“å…¥æ¡†ç»„ä»¶
â”‚       â””â”€â”€ Modal.tsx           # æ¨¡æ€æ¡†ç»„ä»¶
â”œâ”€â”€ pages/                       # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ LoginPage.tsx           # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ CheckInPage.tsx         # æ‰“å¡é¡µé¢
â”‚   â””â”€â”€ AdminPage.tsx           # ç®¡ç†å‘˜é¡µé¢
â”œâ”€â”€ store/                       # çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰
â”‚   â”œâ”€â”€ authStore.ts            # è®¤è¯çŠ¶æ€
â”‚   â”œâ”€â”€ checkinStore.ts         # æ‰“å¡çŠ¶æ€
â”‚   â””â”€â”€ uiStore.ts              # UI çŠ¶æ€
â”œâ”€â”€ services/                    # API æœåŠ¡
â”‚   â””â”€â”€ api.ts                  # Tauri API è°ƒç”¨å°è£…
â”œâ”€â”€ styles/                      # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ globals.css             # å…¨å±€æ ·å¼ï¼ˆTailwind CSSï¼‰
â””â”€â”€ utils/                       # å·¥å…·å‡½æ•°ï¼ˆå¾…æ·»åŠ ï¼‰
    â”œâ”€â”€ time.ts                 # æ—¶é—´å¤„ç†å·¥å…·
    â””â”€â”€ validation.ts           # éªŒè¯å·¥å…·
```

### æ ¸å¿ƒç»„ä»¶ç¤ºä¾‹

```tsx
// CheckInPage.tsx
export const CheckInPage: React.FC = () => {
    const { user } = useAuth();
    const { actionTypes, records, handleCheckIn } = useCheckIn(user.id);
    const [currentTime, setCurrentTime] = useState(new Date());
    
    // å®æ—¶æ›´æ–°æ—¶é—´
    useEffect(() => {
        const timer = setInterval(() => {
            setCurrentTime(getCompanyTime());
        }, 1000);
        return () => clearInterval(timer);
    }, []);
    
    return (
        <div className="check-in-page">
            <Header user={user} currentTime={currentTime} />
            <StatusCard status={calculateStatus(records)} />
            <ActionButtons 
                actionTypes={actionTypes}
                onCheckIn={handleCheckIn}
            />
            <RecordsList records={records} />
        </div>
    );
};
```

---

## ğŸ¯ å®ç°ä¼˜å…ˆçº§

### Phase 1: æ ¸å¿ƒåŠŸèƒ½ï¼ˆMVPï¼‰
1. âœ… æ•°æ®åº“è®¾è®¡ä¸åˆ›å»º
2. âœ… ç™»å½•/æ³¨å†ŒåŠŸèƒ½
3. âœ… åŸºç¡€æ‰“å¡åŠŸèƒ½ï¼ˆä¸Šç­/ä¸‹ç­ï¼‰
4. âœ… æ‰“å¡è®°å½•æ˜¾ç¤º
5. âœ… æ—¶åŒºå¤„ç†

### Phase 2: é«˜çº§åŠŸèƒ½
1. âœ… ä¸´æ—¶äº‹ä»¶æ‰“å¡ï¼ˆåˆé¤ã€å¼€ä¼šç­‰ï¼‰
2. âœ… è¿Ÿåˆ°æ£€æµ‹
3. âœ… è·¨æ—¥å·¥ä½œå‘¨æœŸæ”¯æŒ
4. âœ… è¶…æ—¶æé†’
5. âœ… ä¹è§‚æ›´æ–°ï¼ˆé›¶å»¶è¿ŸUIï¼‰

### Phase 3: ç®¡ç†åŠŸèƒ½
1. âœ… ç®¡ç†å‘˜é¢æ¿
2. âœ… æ‰“å¡ç±»å‹ç®¡ç†
3. âœ… æ—¶é—´è§„åˆ™é…ç½®
4. âœ… å‘˜å·¥ç®¡ç†
5. âœ… æ‰“å¡è®°å½•æŸ¥è¯¢

### Phase 4: æ•°æ®åˆ†æ
1. âœ… ä¸ªäººç»Ÿè®¡æŠ¥è¡¨
2. âœ… æœˆåº¦è€ƒå‹¤ç»Ÿè®¡
3. âœ… Excelå¯¼å‡º

### Phase 5: ä½“éªŒä¼˜åŒ–
1. âœ… å•å®ä¾‹æ£€æµ‹
2. âœ… ä¼šè¯æŒä¹…åŒ–
3. âœ… ä¸»é¢˜ç³»ç»Ÿ
4. âœ… é”™è¯¯å¤„ç†ä¼˜åŒ–
5. â³ åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœï¼ˆTauriæ–°å¢ï¼‰

---

## ğŸ”’ å®‰å…¨è€ƒè™‘

1. **å¯†ç å®‰å…¨**ï¼š
   - ä½¿ç”¨ SHA256 å“ˆå¸Œå­˜å‚¨
   - å»ºè®®ï¼šå‡çº§ä¸º bcrypt æˆ– argon2

2. **SQL æ³¨å…¥é˜²æŠ¤**ï¼š
   - ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
   - Supabase è‡ªå¸¦ RLSï¼ˆè¡Œçº§å®‰å…¨ï¼‰

3. **ä¼šè¯å®‰å…¨**ï¼š
   - æœ¬åœ°ä¼šè¯æ–‡ä»¶åŠ å¯†
   - å®šæœŸéªŒè¯ä¼šè¯æœ‰æ•ˆæ€§

4. **æƒé™æ§åˆ¶**ï¼š
   - ç®¡ç†å‘˜åŠŸèƒ½å‰åç«¯åŒé‡éªŒè¯
   - Supabase RLSç­–ç•¥

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

1. **æ•°æ®åº“æŸ¥è¯¢**ï¼š
   - æ·»åŠ ç´¢å¼•ï¼ˆuser_id, check_time, statusï¼‰
   - åˆ†é¡µåŠ è½½å†å²è®°å½•

2. **UI æ¸²æŸ“**ï¼š
   - è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§é‡è®°å½•æ—¶ï¼‰
   - React.memo ä¼˜åŒ–é‡æ¸²æŸ“

3. **ç½‘ç»œè¯·æ±‚**ï¼š
   - æ‰¹é‡æŸ¥è¯¢
   - ç¼“å­˜å¸¸ç”¨æ•°æ®ï¼ˆaction_types, time_rulesï¼‰

4. **æ‰“åŒ…ä¼˜åŒ–**ï¼š
   - Tauri æ”¯æŒå¢é‡æ›´æ–°
   - æŒ‰éœ€åŠ è½½æ¨¡å—

---

## ğŸ§ª æµ‹è¯•å»ºè®®

1. **å•å…ƒæµ‹è¯•**ï¼š
   - ä¸šåŠ¡é€»è¾‘å‡½æ•°ï¼ˆè¿Ÿåˆ°æ£€æµ‹ã€è·¨æ—¥åˆ¤æ–­ï¼‰
   - API è°ƒç”¨æ¨¡æ‹Ÿ

2. **é›†æˆæµ‹è¯•**ï¼š
   - å®Œæ•´æ‰“å¡æµç¨‹
   - é…å¯¹æœºåˆ¶
   - ç»Ÿè®¡è®¡ç®—

3. **UI æµ‹è¯•**ï¼š
   - æŒ‰é’®äº¤äº’
   - è¡¨å•éªŒè¯
   - é”™è¯¯æç¤º

4. **ç«¯åˆ°ç«¯æµ‹è¯•**ï¼š
   - ç”¨æˆ·å®Œæ•´å·¥ä½œæµ
   - è·¨æ—¶åŒºåœºæ™¯

---

## ğŸ“š é™„å½•

### A. å¸¸ç”¨æ—¶åŒºåˆ—è¡¨
```
Asia/Shanghai       # ä¸­å›½ UTC+8
Asia/Phnom_Penh     # æŸ¬åŸ”å¯¨ UTC+7
Asia/Tokyo          # æ—¥æœ¬ UTC+9
America/New_York    # ç¾å›½ä¸œéƒ¨ UTC-5/-4
Europe/London       # è‹±å›½ UTC+0/+1
```

### B. çŠ¶æ€ç å®šä¹‰
```
æ‰“å¡çŠ¶æ€ (check_ins.status)
- ongoing: è¿›è¡Œä¸­
- completed: å·²å®Œæˆ
- overtime: è¶…æ—¶

è§’è‰²ç±»å‹ (action_types.action_role)
- 1: è¿›ç¨‹å¼€å§‹ï¼ˆä¸Šç­ï¼‰
- 2: è¿›ç¨‹ç»“æŸï¼ˆä¸‹ç­ï¼‰
- 3: äº‹ä»¶å¼€å§‹ï¼ˆä¸´æ—¶äº‹ä»¶ï¼‰
- 4: äº‹ä»¶ç»“æŸï¼ˆå›åº§ï¼‰
```

### C. é¢œè‰²è§„èŒƒ
```css
/* ç³»ç»Ÿé»˜è®¤é¢œè‰² */
--color-success: #4CAF50;  /* ä¸Šç­ */
--color-danger: #F44336;   /* ä¸‹ç­ */
--color-warning: #FF9800;  /* åˆé¤ */
--color-info: #2196F3;     /* ä¸Šå•æ‰€ */
--color-purple: #9C27B0;   /* å¼€ä¼š */
--color-gray: #607D8B;     /* å›åº§ */
```

---

## ğŸ“ è”ç³»ä¸æ”¯æŒ

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·æŸ¥é˜…ï¼š
- Supabase æ–‡æ¡£ï¼šhttps://supabase.com/docs
- Tauri æ–‡æ¡£ï¼šhttps://tauri.app/
- React æ–‡æ¡£ï¼šhttps://react.dev/

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-12-22  
**ä½œè€…**: AI Assistant  
**é€‚ç”¨èŒƒå›´**: Tauri ç‰ˆæœ¬å¼€å‘å‚è€ƒ

